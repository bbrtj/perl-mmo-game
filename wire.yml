env:
    class: Component::Env

db:
    class: Component::DB
    args:
        env:
            $ref: env

worker:
    class: Component::Worker
    args:
        env:
            $ref: env

redis:
    class: Component::Redis
    args:
        env:
            $ref: env

log:
    class: Component::Log
    args:
        filename: 'logs/application.log'

encoder:
    class: Sereal::Encoder

decoder:
    class: Sereal::Decoder

# Repositories

schema_repo:
    class: Repository::Schema
    args:
        db:
            $ref: db

char_cache:
    class: Repository::CharCache
    args:
        redis:
            $ref: redis

lore_data:
    class: Repository::LoreData
    args:
        db:
            $ref: db

units:
    class: Repository::Units
    args:
        db:
            $ref: db
        repo:
            $ref: schema_repo

# Services

user_service:
    class: Service::User
    args:
        repo:
            $ref: schema_repo

channel_service:
    class: Service::Channel
    args:
        store:
            $ref: redis
        encoder:
            $ref: encoder
        decoder:
            $ref: decoder
